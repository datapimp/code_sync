(function(){var e,t,n,r=[].slice;t=this,t.CodeSync=e=function(){return e.Client.get()},e.VERSION="0.6.8",e.backends={},e.util={},e.plugins={},e._config||(e._config={defaultFileType:"coffeescript",assetCompilationEndpoint:"http://localhost:9295/source",serverInfoEndpoint:"http://localhost:9295/info",sprocketsEndpoint:"http://localhost:9295/assets",socketEndpoint:"http://localhost:9295/faye",editorToggleHotkey:"ctrl+j",debugMode:!1,defaultKeyBindings:"default"}),e.set=function(t,n){return e._config[t]=n},e.get=function(t){return e._config[t]},e.enableLogging=function(){return e.set("debugMode",!0)},e.log=function(){var t;t=1<=arguments.length?r.call(arguments,0):[];if(e.get("debugMode")!==!1)return t.unshift("CodeSync Log:"),console.log.apply(console,t)},n=CodeMirror.prototype.setOption,e.set("defaultKeyBindings","vim")}).call(this),function(){var e;CodeSync.Client=function(){function t(t){var n=this;t==null&&(t={}),this.logLevel=t.logLevel||0,CodeSync.Client._clients.push(this),this.enablePush===!0&&(this.channel=t.channel||e(),this.providerLib=""+CodeSync.get("socketEndpoint")+"/client.js",CodeSync.util.loadScript(this.providerLib,function(){if(n.clientLoaded===!0||!n.providerAvailable())return;return setTimeout(function(){try{return n.setupSocket()}catch(e){return console.log("Error setting up codesync client: "+e.message)}},25),n.clientLoaded=!0})),this.getSprocketsInfo()}return t._clients=[],t.get=function(){return CodeSync.Client._clients[0]},t.prototype.VERSION=CodeSync.VERSION,t.prototype.logLevel=0,t.prototype.enablePush=!0,t.prototype.getSprocketsInfo=function(){var e=this;return $.ajax({type:"GET",url:CodeSync.get("serverInfoEndpoint"),success:function(t){t==null&&(t={}),CodeSync.set("latestServerInfo",t),t.root&&CodeSync.set("projectRoot",t.root);if(t.project_assets!=null&&CodeSync.ProjectAssets!=null)return e.projectAssets=new CodeSync.ProjectAssets(t.project_assets)}})},t.prototype.buildStylesheetMap=function(){var e,t,n,r,i,s;this.stylesheetMap={},i=$('link[rel="stylesheet"]'),s=[];for(n=0,r=i.length;n<r;n++)t=i[n],(e=$(t).attr("href"))?s.push(this.stylesheetMap[e]=t):s.push(void 0);return s},t.prototype.buildScriptMap=function(){var e,t,n,r,i;this.scriptMap={},i=$('script[type="text/javascript"]');for(n=0,r=i.length;n<r;n++){e=i[n];if(t=$(e).attr("src"))this.scriptMap[t]=e}return this.scriptMap},t.prototype.providerAvailable=function(){return typeof Faye!="undefined"&&Faye!==null},t.prototype.subscribeWith=function(e){var t;return(t=this.socket)!=null?t.subscribe(this.channel,e):void 0},t.prototype.setupSocket=function(){var e=this;if(this.socket=typeof Faye!="undefined"&&Faye!==null?new Faye.Client(CodeSync.get("socketEndpoint")):void 0)return this.subscribeWith(function(){return e.defaultNotificationHandler.apply(e,arguments)})},t.prototype.notificationHandlerOptions={},t.prototype.defaultNotificationHandler=function(e){var t,n,r;return(t=(r=this.projectAssets)!=null?r.findDocumentByPath(e.path):void 0)&&e.contents&&(t.set("contents",e.contents,{silent:!1}),t.trigger("contents:synced")),n=this.notificationHandlerOptions,n.origin="watcher",CodeSync.processChangeNotification(e,n)},t}(),e=function(e){var t,n,r,i,s,o,u;r=window.location.search.substring(1),i=r.split("&");for(s=0,o=i.length;s<o;s++)t=i[s],t.match(/code_sync_channel/)&&e==null&&(u=t.split("="),n=u[0],e=u[1]);return e?decodeURIComponent("/code-sync/"+e):"/code-sync/outbound"}}.call(this),function(){CodeSync.util||(CodeSync.util={}),window.CodeSyncloadedScripts={},window.CodeSyncscriptTimers={},CodeSync.util.loadStylesheet=function(e,t,n){var r;return t==null&&(t={}),n||(n=t.complete||t.callback),typeof t=="function"&&n==null&&(n=t,t={}),r=document.createElement("link"),r.type="text/css",r.rel="stylesheet",r.href=e,r.className="code-sync-asset",t.tracker&&($("link[data-tracker='"+t.tracker+"']").remove(),r.setAttribute("data-tracker",t.tracker)),document.getElementsByTagName("head")[0].appendChild(r),n!=null?typeof n.call=="function"?n.call(this,e,t):void 0:void 0},CodeSync.util.loadScript=function(e,t,n){var r,i,s,o,u,a;t==null&&(t={}),i=window.CodeSyncloadedScripts,a=window.CodeSyncscriptTimers,n||(n=t.complete||t.callback),typeof t=="function"&&n==null&&(n=t,t={}),r=document.getElementsByTagName("head")[0],o=document.createElement("script"),o.src=e,o.type="text/javascript",u=this,s=function(){typeof n=="function"&&n.call(u,e,t,o);try{r.removeChild(o)}catch(s){!0}return i[e]=!0};if(t.once===!0&&i[e])return!1;r.appendChild(o),o.onreadystatechange=function(){if(o.readyState==="loaded"||o.readyState==="complete")return s()},o.onload=s;if(typeof navigator!="undefined"&&navigator!==null?navigator.userAgent.match(/WebKit/):void 0)return a[e]=setInterval(function(){return s(),clearInterval(a[e])},10)},CodeSync.util.inspectElementsWithin=function(e){var t,n,r,i,s,o,u,a;return e==null&&(e={}),u=e.root,i=e.el,o=e.fn,u||(u=window),n=function(e){var t;return t=$(e.target),t.css({"background-color":"#9FC4E7",opacity:.5}),t.children().each(function(e,t){return $(t).css({"background-color":"#C2DDB6",opacity:.5})})},a=function(e){var t;return t=$(e.target),t.attr("style",""),t.children().each(function(e,t){return $(t).attr("style","")})},r=function(){return u.$("*").off(".inspekt"),i},e.disable?r():(t=_.debounce(function(e){return a(e),u.$(i).trigger("inspekt",e,u.$(e.target)),r()},150),s=u.$(i).find("*"),s.off(".inspekt"),s.on("mouseover.inspekt",n).on("mouseout.inspekt",a).on("click.inspekt",function(e){return t(e),s.off(".inspekt")}),u.$(i))}}.call(this),function(){var evalRunner,_this=this;evalRunner=function(code,onError){try{return eval(code)}catch(e){throw typeof onError=="function"&&onError(e.message),e}},CodeSync.detectGlobalChangeTriggers=function(e,t){return t==null&&(t={}),!0},CodeSync.onScriptChange=CodeSync.onTemplateChange=CodeSync.onStyleChange=function(){return!0},CodeSync.processChangeNotification=function(e,t){var n,r,i,s,o;e==null&&(e={}),t==null&&(t={}),s=e.type,n=e.compiled,r=e.content;if((typeof CodeSync.beforeChange=="function"?CodeSync.beforeChange(e,t):void 0)===!1)return;e.template===!0&&(s||(s="template"));if(s==null){if((o=e.logical_name)!=null?o.match(".css"):void 0)s="stylesheet";e.logical_name.match(".js")&&(s="script")}CodeSync.detectGlobalChangeTriggers(s,e);switch(s){case"stylesheet":$("head style[data-codesync-document='"+t.origin+"']").remove(),$("head").append("<style type='text/css' data-codesync-document='"+t.origin+"'>"+n+"</style>"),i=CodeSync.onStyleChange;break;case"template":evalRunner(n,e.error),i=CodeSync.onTemplateChange;break;case"script":evalRunner(n,e.error),i=CodeSync.onScriptChange}return _.delay(function(){return typeof i=="function"&&i(e,t),typeof e.complete=="function"&&e.complete(e,t),typeof e.success=="function"?e.success(e,t):void 0},150)}}.call(this),function(){if(typeof _=="undefined"||_===null)throw"CodeSync depends on the underscore library at this time"}.call(this);